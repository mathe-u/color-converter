<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Conversor de Cores - Matheus</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
</head>

<body>
    <div class="container">
        <div class="picker-section">
            <div class="section-title">Conversor de Cores</div>
            <div id="picker">
                <div class="selector" id="sv-selector"></div>
            </div>
            <div id="hue-slider">
                <div class="selector" id="hue-selector"></div>
            </div>
        </div>

        <div class="inputs-section">
            <div id="inputs">
                <label>
                    <span class="format-label">HEX:</span>
                    <div class="input-copy-group">
                        <input type="text" id="hex-input" maxlength="7" placeholder="#RRGGBB">
                        <button class="copy-btn" data-format="hex" title="Copiar HEX">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z">
                                </path>
                            </svg>
                        </button>
                    </div>
                </label>

                <label>
                    <span class="format-label">RGB:</span>
                    <div class="input-copy-group">
                        <div class="input-group">
                            <input type="number" id="r-input" min="0" max="255" step="1" placeholder="R">
                            <input type="number" id="g-input" min="0" max="255" step="1" placeholder="G">
                            <input type="number" id="b-input" min="0" max="255" step="1" placeholder="B">
                        </div>
                        <button class="copy-btn" data-format="rgb" title="Copiar RGB">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z">
                                </path>
                            </svg>
                        </button>
                    </div>
                </label>

                <label>
                    <span class="format-label">HSL:</span>
                    <div class="input-copy-group">
                        <div class="input-group">
                            <input type="number" id="h-input" min="0" max="360" step="1" placeholder="H">,
                            <input type="number" id="s-input" min="0" max="100" step="1" placeholder="S">,
                            <input type="number" id="l-input" min="0" max="100" step="1" placeholder="L">
                        </div>
                        <button class="copy-btn" data-format="hsl" title="Copiar HSL">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z">
                                </path>
                            </svg>
                        </button>
                    </div>
                </label>

                <label>
                    <span class="format-label">HSV:</span>
                    <div class="input-copy-group">
                        <div class="input-group">
                            <input type="number" id="hsv-h-input" min="0" max="360" step="1" placeholder="H">,
                            <input type="number" id="hsv-s-input" min="0" max="100" step="1" placeholder="S">,
                            <input type="number" id="hsv-v-input" min="0" max="100" step="1" placeholder="V">
                        </div>
                        <button class="copy-btn" data-format="hsv" title="Copiar HSV">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z">
                                </path>
                            </svg>
                        </button>
                    </div>
                </label>

                <label>
                    <span class="format-label">CMYK:</span>
                    <div class="input-copy-group">
                        <div class="input-group">
                            <input type="number" id="c-input" min="0" max="100" step="1" placeholder="C">,
                            <input type="number" id="m-input" min="0" max="100" step="1" placeholder="M">,
                            <input type="number" id="y-input" min="0" max="100" step="1" placeholder="Y">,
                            <input type="number" id="k-input" min="0" max="100" step="1" placeholder="K">
                        </div>
                        <button class="copy-btn" data-format="cmyk" title="Copiar CMYK">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z">
                                </path>
                            </svg>
                        </button>
                    </div>
                </label>
            </div>
        </div>
    </div>

    <script>
        const picker = document.getElementById('picker');
        const svSelector = document.getElementById('sv-selector');
        const hueSlider = document.getElementById('hue-slider');
        const hueSelector = document.getElementById('hue-selector');

        // Inputs
        const hexInput = document.getElementById('hex-input');
        const rInput = document.getElementById('r-input');
        const gInput = document.getElementById('g-input');
        const bInput = document.getElementById('b-input');
        const hInput = document.getElementById('h-input');
        const sInput = document.getElementById('s-input');
        const lInput = document.getElementById('l-input');
        const hsvHInput = document.getElementById('hsv-h-input');
        const hsvSInput = document.getElementById('hsv-s-input');
        const hsvVInput = document.getElementById('hsv-v-input');
        const cInput = document.getElementById('c-input');
        const mInput = document.getElementById('m-input');
        const yInput = document.getElementById('y-input');
        const kInput = document.getElementById('k-input');

        let h = 0; // hue 0-360
        let s = 1; // saturation 0-1
        let v = 1; // value 0-1

        function hsvToRgb(h, s, v) {
            let r, g, b;
            let i = Math.floor(h / 60);
            let f = h / 60 - i;
            let p = v * (1 - s);
            let q = v * (1 - f * s);
            let t = v * (1 - (1 - f) * s);
            switch (i % 6) {
                case 0: r = v; g = t; b = p; break;
                case 1: r = q; g = v; b = p; break;
                case 2: r = p; g = v; b = t; break;
                case 3: r = p; g = q; b = v; break;
                case 4: r = t; g = p; b = v; break;
                case 5: r = v; g = p; b = q; break;
            }
            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }

        function rgbToHex(r, g, b) {
            return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`.toUpperCase();
        }

        function hexToRgb(hex) {
            hex = hex.replace('#', '');
            if (hex.length === 3) {
                hex = hex.split('').map(char => char + char).join('');
            }
            return {
                r: parseInt(hex.substring(0, 2), 16),
                g: parseInt(hex.substring(2, 4), 16),
                b: parseInt(hex.substring(4, 6), 16)
            };
        }

        function rgbToHsl(r, g, b) {
            r /= 255; g /= 255; b /= 255;
            let max = Math.max(r, g, b), min = Math.min(r, g, b);
            let hslH, hslS, hslL = (max + min) / 2;
            if (max === min) {
                hslH = hslS = 0;
            } else {
                let d = max - min;
                hslS = hslL > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: hslH = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: hslH = (b - r) / d + 2; break;
                    case b: hslH = (r - g) / d + 4; break;
                }
                hslH /= 6;
            }
            return { hslH: hslH * 360, hslS: hslS * 100, hslL: hslL * 100 };
        }

        function hslToRgb(hslH, hslS, hslL) {
            hslH /= 360; hslS /= 100; hslL /= 100;
            let r, g, b;
            if (hslS === 0) {
                r = g = b = hslL;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1 / 6) return p + (q - p) * 6 * t;
                    if (t < 1 / 2) return q;
                    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
                    return p;
                };
                const q = hslL < 0.5 ? hslL * (1 + hslS) : hslL + hslS - hslL * hslS;
                const p = 2 * hslL - q;
                r = hue2rgb(p, q, hslH + 1 / 3);
                g = hue2rgb(p, q, hslH);
                b = hue2rgb(p, q, hslH - 1 / 3);
            }
            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }

        function rgbToHsv(r, g, b) {
            r /= 255; g /= 255; b /= 255;
            let max = Math.max(r, g, b), min = Math.min(r, g, b);
            let hsvH, hsvS, hsvV = max;
            let d = max - min;
            hsvS = max === 0 ? 0 : d / max;
            if (max === min) {
                hsvH = 0;
            } else {
                switch (max) {
                    case r: hsvH = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: hsvH = (b - r) / d + 2; break;
                    case b: hsvH = (r - g) / d + 4; break;
                }
                hsvH /= 6;
            }
            return { hsvH: hsvH * 360, hsvS: hsvS * 100, hsvV: hsvV * 100 };
        }

        function rgbToCmyk(r, g, b) {
            r /= 255; g /= 255; b /= 255;
            let k = 1 - Math.max(r, Math.max(g, b));
            if (k === 1) {
                return { c: 0, m: 0, y: 0, k: 100 };
            }
            let c = (1 - r - k) / (1 - k);
            let m = (1 - g - k) / (1 - k);
            let y = (1 - b - k) / (1 - k);
            return {
                c: Math.round(c * 100),
                m: Math.round(m * 100),
                y: Math.round(y * 100),
                k: Math.round(k * 100)
            };
        }

        function cmykToRgb(c, m, y, k) {
            c /= 100; m /= 100; y /= 100; k /= 100;
            let r = 255 * (1 - c) * (1 - k);
            let g = 255 * (1 - m) * (1 - k);
            let b = 255 * (1 - y) * (1 - k);
            return {
                r: Math.round(r),
                g: Math.round(g),
                b: Math.round(b)
            };
        }

        function updateColor(fromInputs = false) {
            const { r, g, b } = hsvToRgb(h, s, v);
            const hex = rgbToHex(r, g, b);
            const { hslH, hslS, hslL } = rgbToHsl(r, g, b);
            const { hsvH, hsvS, hsvV } = rgbToHsv(r, g, b);
            const { c, m, y, k } = rgbToCmyk(r, g, b);

            document.body.style.backgroundColor = `rgb(${r},${g},${b})`;

            picker.style.background = `linear-gradient(to top, black 0%, transparent 100%),
                                        linear-gradient(to right, white 0%, hsl(${h}, 100%, 50%) 100%)`;

            if (!fromInputs) {
                hexInput.value = hex;
                rInput.value = r;
                gInput.value = g;
                bInput.value = b;
                hInput.value = Math.round(hslH);
                sInput.value = Math.round(hslS);
                lInput.value = Math.round(hslL);
                hsvHInput.value = Math.round(hsvH);
                hsvSInput.value = Math.round(hsvS);
                hsvVInput.value = Math.round(hsvV);
                cInput.value = c;
                mInput.value = m;
                yInput.value = y;
                kInput.value = k;
            }
        }

        function updateFromHex() {
            let hex = hexInput.value.toUpperCase();
            if (!/^#([0-9A-F]{3}){1,2}$/i.test(hex)) return;
            const { r, g, b } = hexToRgb(hex);
            updateFromRgb(r, g, b);
        }

        function updateFromRgb(r = null, g = null, b = null) {
            if (r === null) r = parseInt(rInput.value) || 0;
            if (g === null) g = parseInt(gInput.value) || 0;
            if (b === null) b = parseInt(bInput.value) || 0;

            r = Math.max(0, Math.min(255, r));
            g = Math.max(0, Math.min(255, g));
            b = Math.max(0, Math.min(255, b));

            const { hsvH, hsvS, hsvV } = rgbToHsv(r, g, b);
            h = hsvH;
            s = hsvS / 100;
            v = hsvV / 100;
            updateSelectors();
            updateColor(true);

            const hex = rgbToHex(r, g, b);
            const { hslH, hslS, hslL } = rgbToHsl(r, g, b);
            const { c, m, y, k } = rgbToCmyk(r, g, b);

            hexInput.value = hex;
            hInput.value = Math.round(hslH);
            sInput.value = Math.round(hslS);
            lInput.value = Math.round(hslL);
            hsvHInput.value = Math.round(hsvH);
            hsvSInput.value = Math.round(hsvS);
            hsvVInput.value = Math.round(hsvV);
            cInput.value = c;
            mInput.value = m;
            yInput.value = y;
            kInput.value = k;
        }

        function updateFromHsl() {
            let hslH = parseFloat(hInput.value) || 0;
            let hslS = parseFloat(sInput.value) || 0;
            let hslL = parseFloat(lInput.value) || 0;

            hslH = Math.max(0, Math.min(360, hslH));
            hslS = Math.max(0, Math.min(100, hslS));
            hslL = Math.max(0, Math.min(100, hslL));

            const { r, g, b } = hslToRgb(hslH, hslS, hslL);
            updateFromRgb(r, g, b);
        }

        function updateFromHsv() {
            let hsvH = parseFloat(hsvHInput.value) || 0;
            let hsvS = parseFloat(hsvSInput.value) || 0;
            let hsvV = parseFloat(hsvVInput.value) || 0;

            hsvH = Math.max(0, Math.min(360, hsvH));
            hsvS = Math.max(0, Math.min(100, hsvS));
            hsvV = Math.max(0, Math.min(100, hsvV));

            h = hsvH;
            s = hsvS / 100;
            v = hsvV / 100;
            updateSelectors();
            updateColor(true);

            const { r, g, b } = hsvToRgb(h, s, v);
            const hex = rgbToHex(r, g, b);
            const { hslH, hslS, hslL } = rgbToHsl(r, g, b);
            const { c, m, y, k } = rgbToCmyk(r, g, b);

            hexInput.value = hex;
            rInput.value = r;
            gInput.value = g;
            bInput.value = b;
            hInput.value = Math.round(hslH);
            sInput.value = Math.round(hslS);
            lInput.value = Math.round(hslL);
            cInput.value = c;
            mInput.value = m;
            yInput.value = y;
            kInput.value = k;
        }

        function updateFromCmyk() {
            let c = parseFloat(cInput.value) || 0;
            let m = parseFloat(mInput.value) || 0;
            let y = parseFloat(yInput.value) || 0;
            let k = parseFloat(kInput.value) || 0;

            c = Math.max(0, Math.min(100, c));
            m = Math.max(0, Math.min(100, m));
            y = Math.max(0, Math.min(100, y));
            k = Math.max(0, Math.min(100, k));

            const { r, g, b } = cmykToRgb(c, m, y, k);
            updateFromRgb(r, g, b);
        }

        function updateSelectors() {
            hueSelector.style.left = `${(h / 360) * 100}%`;
            svSelector.style.left = `${s * 100}%`;
            svSelector.style.top = `${(1 - v) * 100}%`;
        }

        function handleDrag(slider, onDrag) {
            function start(e) {
                onDrag(e);
                window.addEventListener('mousemove', onDrag);
                window.addEventListener('touchmove', onDrag);
                window.addEventListener('mouseup', end);
                window.addEventListener('touchend', end);
            }
            function end() {
                window.removeEventListener('mousemove', onDrag);
                window.removeEventListener('touchmove', onDrag);
            }
            slider.addEventListener('mousedown', start);
            slider.addEventListener('touchstart', start);
        }

        handleDrag(hueSlider, (e) => {
            const rect = hueSlider.getBoundingClientRect();
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            let left = (clientX - rect.left) / rect.width;
            h = Math.max(0, Math.min(1, left)) * 360;
            hueSelector.style.left = `${(h / 360) * 100}%`;
            updateColor();
        });

        handleDrag(picker, (e) => {
            const rect = picker.getBoundingClientRect();
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            s = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
            v = 1 - Math.max(0, Math.min(1, (clientY - rect.top) / rect.height));
            svSelector.style.left = `${s * 100}%`;
            svSelector.style.top = `${(1 - v) * 100}%`;
            updateColor();
        });


        hexInput.addEventListener('input', updateFromHex);
        [rInput, gInput, bInput].forEach(el => el.addEventListener('input', () => updateFromRgb()));
        [hInput, sInput, lInput].forEach(el => el.addEventListener('input', updateFromHsl));
        [hsvHInput, hsvSInput, hsvVInput].forEach(el => el.addEventListener('input', updateFromHsv));
        [cInput, mInput, yInput, kInput].forEach(el => el.addEventListener('input', updateFromCmyk));

        const copyIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg>`;
        const successIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"></path></svg>`;

        document.querySelectorAll('.copy-btn').forEach(button => {
            button.addEventListener('click', () => {
                const format = button.dataset.format;
                let textToCopy = '';

                switch (format) {
                    case 'hex':
                        textToCopy = hexInput.value;
                        break;
                    case 'rgb':
                        textToCopy = `rgb(${rInput.value}, ${gInput.value}, ${bInput.value})`;
                        break;
                    case 'hsl':
                        textToCopy = `hsl(${hInput.value}, ${sInput.value}%, ${lInput.value}%)`;
                        break;
                    case 'hsv':
                        textToCopy = `hsv(${hsvHInput.value}, ${hsvSInput.value}%, ${hsvVInput.value}%)`;
                        break;
                    case 'cmyk':
                        textToCopy = `cmyk(${cInput.value}%, ${mInput.value}%, ${yInput.value}%, ${kInput.value}%)`;
                        break;
                }

                if (textToCopy && navigator.clipboard) {
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        button.innerHTML = successIconSVG;
                        setTimeout(() => {
                            button.innerHTML = copyIconSVG;
                        }, 2000);
                    }).catch(err => {
                        console.error('Falha ao copiar o texto: ', err);
                        alert('Falha ao copiar!');
                    });
                }
            });
        });

        // Inicialização
        hueSelector.style.left = '0%';
        svSelector.style.left = '100%';
        svSelector.style.top = '0%';
        updateColor();
    </script>
</body>

</html>